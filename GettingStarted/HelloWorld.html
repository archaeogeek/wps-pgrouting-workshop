<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <title>Hello World | WPS PgRouting Workshop OSGIS 2014</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.3.1">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="../Geoprocessing/Introduction.html" />
    
    
    <link rel="prev" href="../GettingStarted/Customising.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book" data-level="2.2" data-basepath=".." data-revision="1416661240592">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="Introduction/Overview.html">
            
                
                    <a href="../Introduction/Overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         Overview
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.1" data-path="Introduction/Summary.html">
            
                
                    <a href="../Introduction/Summary.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         Package Summary
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="Introduction/installation.html">
            
                
                    <a href="../Introduction/installation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                         Installation
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="GettingStarted/GettingStarted.html">
            
                
                    <a href="../GettingStarted/GettingStarted.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         Getting Started
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1" data-path="GettingStarted/Customising.html">
            
                
                    <a href="../GettingStarted/Customising.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                         Customising Your Server
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter active" data-level="2.2" data-path="GettingStarted/HelloWorld.html">
            
                
                    <a href="../GettingStarted/HelloWorld.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                         Hello World
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="Geoprocessing/Introduction.html">
            
                
                    <a href="../Geoprocessing/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         Basic Geoprocessing
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.1" data-path="Geoprocessing/Testing.html">
            
                
                    <a href="../Geoprocessing/Testing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                         Testing with QGIS
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4" data-path="Routing/Overview.html">
            
                
                    <a href="../Routing/Overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         Routing
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.1" data-path="Routing/Functions.html">
            
                
                    <a href="../Routing/Functions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                         Routing Functions
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.2" data-path="Routing/PgAdmin3.html">
            
                
                    <a href="../Routing/PgAdmin3.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                         Testing in PgAdmin3
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.3" data-path="Routing/QGIS.html">
            
                
                    <a href="../Routing/QGIS.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                         Testing in QGIS
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.4" data-path="Routing/WPS.html">
            
                
                    <a href="../Routing/WPS.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                         Adding to our WPS
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.5" data-path="Routing/Map.html">
            
                
                    <a href="../Routing/Map.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                         Using this on a web-based map
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5" data-path="Appendix/Acknowledgements.html">
            
                
                    <a href="../Appendix/Acknowledgements.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                         Wrapping Up
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6" data-path="Appendix/Proxy.html">
            
                
                    <a href="../Appendix/Proxy.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         University of Nottingham Proxy
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >WPS PgRouting Workshop OSGIS 2014</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_7">
                    
                        <h1 id="hello-world">Hello World!</h1>
<p>Building a &quot;Hello World&quot; service is a good way of understanding how ZOO services are put together.</p>
<p>ZOO services comprise a metadata or configuration file (.ZCFG) and a service provider file. The format of this depends on the programming language used, but we&#39;re going to use python. Publishing a service is simply a case of creating the appropriate .zcfg and .py files in the same directory as the zoo_loader.cgi file.</p>
<h2 id="the-zcfg-file">The .zcfg file</h2>
<p>In the file manager, navigate to the /usr/lib/cgi-bin directory and right-click the file &#39;Hello.zcfg&#39; then open it in medit. You&#39;ll see that it looks something like the following:</p>
<pre><code>[Hello]
 Title = Return a hello message.
 Abstract = Say Hello to the person named in the input.
 processVersion = 2
 storeSupported = true
 statusSupported = true
 serviceProvider = hello_service
 serviceType = Python
 &lt;DataInputs&gt;
  [name]
   Title = Input string
   Abstract = The name to insert in the hello message.
   minOccurs = 1
   maxOccurs = 1
   &lt;LiteralData&gt;
       dataType = string
       &lt;Default /&gt;
   &lt;/LiteralData&gt;
 &lt;/DataInputs&gt;
 &lt;DataOutputs&gt;
  [Result]
   Title = The resulting string
   Abstract = The hello message containing the input name
  &lt;LiteralData&gt;
       dataType = string
      &lt;Default /&gt;
   &lt;/LiteralData&gt;
 &lt;/DataOutputs&gt;
</code></pre><p>The first 8 lines contain metadata about the service. These include the following:</p>
<ul>
<li><strong>processVersion</strong>: A user-defined version number for the service;</li>
<li><strong>storeSupported</strong>: Should ZOO be able to store the results of the service? (True/False);</li>
<li><strong>statusSupported</strong>: Should ZOO be able to run the service as a background task? (True/False);</li>
<li><strong>serviceProvider</strong>: The name of the file containing the code for the service;</li>
<li><strong>serviceType</strong>:  The programming language used.</li>
</ul>
<p>This section can also contain a &lt;MetaData&gt; section if you like, containing additional information about the service.</p>
<p>Below the metadata section are the DataInputs and DataOutputs sections. The DataInputs block contains the following:</p>
<ul>
<li><strong>[name]</strong>: The name of the input- this is how it will be referred to in the service code;</li>
<li><strong>Title/Abstract</strong>: Metadata about the input, for use in the DescribeProcess response;</li>
<li><strong>minOccurs/maxOccurs</strong>: Mandatory- the number of times the input will occur;</li>
<li><strong>&lt;LiteralData&gt;</strong>: The type of data node for the input. Remember from the introduction that the data type can either be LiteralData, BoundingBoxData or ComplexData;</li>
<li><strong>dataType</strong>: The type of data for the given node;</li>
<li><strong>&lt;Default /&gt;</strong>: Mandatory section, but not used for LiteralData types.</li>
</ul>
<p>The DataOutputs block contains very similar sections, but instead of describing the input, it&#39;s describing the output response. Therefore it doesn&#39;t need to contain the minOccurs/maxOccurs sections.</p>
<p>For more detailed information on the type of parameters that can be present in a .zcfg file, read <a href="http://zoo-project.org/docs/services/zcfg-reference.html" target="_blank">the ZOO .zcfg reference</a>.</p>
<h2 id="the-service-file">The service file</h2>
<p>ZOO services files in python contain functions corresponding to each of the services that you wish to publish. They can also contain helper functions for geometry processing and such like, but our first one will be as simple as possible!</p>
<p>Each service function must return an integer value representing the execution status of the service, as defined in the <a href="http://zoo-project.org/docs/api/zoo.html" target="_blank">ZOO API</a>.</p>
<p>Each service takes exactly three arguments, and these are in the form of python dictionaries, which are a type of Key Value Pair:</p>
<ul>
<li><strong>conf</strong>: the main environment configuration (eg the information from main.cfg);</li>
<li><strong>inputs</strong>: the requested or default inputs;</li>
<li><strong>outputs</strong>: the requested or default outputs.</li>
</ul>
<p>If you open hello_service.py in a text editor you will see the following:</p>
<pre><code>import zoo
def Hello(conf,inputs,outputs):
    outputs[&quot;result&quot;][&quot;value&quot;]=\
        &quot;Hello &quot;+inputs[&quot;name&quot;][&quot;value&quot;]+&quot; from the ZOO WPS Server!&quot;
    return zoo.SERVICE_SUCCEEDED
</code></pre><p>This contains the following sections:</p>
<ul>
<li><strong>import zoo</strong>: Tells Python to import the zoo modules for use in this script;</li>
<li><strong>def Hello(conf,inputs,outputs)</strong>: defines the Hello function and its parameters;</li>
<li><strong>outputs</strong>: The Result/Value KVP containing the output &#39;Hello World&#39; string built from;</li>
<li><strong>inputs</strong>: The name/value KVP containing the input string;</li>
<li><strong>return</strong>: The integer value for SERVICE_SUCCEEDED.</li>
</ul>
<p>Note that the service file must obey normal python tab and spacing rules, and that the output and input dictionary KVP must have the same case as their declarations in the .zcfg file.</p>
<p>Feel free to edit the output string so that the service returns a different response, but remember to save your file when you&#39;re done!</p>
<h2 id="testing">Testing</h2>
<p>If you re-load your GetCapabilities Request in your browser now, and do a search for &#39;Hello&#39; in the page, you should see the declaration for your Hello service, complete with the metadata from the [main] section in hello.zcfg.</p>
<p>The next step is to make a DescribeProcess request. Our basic URL is always going to be the following:</p>
<pre><code>http://localhost/cgi-bin/zoo_loader.cgi?Service=WPS&amp;Version=1.0.0&amp;
</code></pre><p>We then add the correct Request type and service identifier:</p>
<pre><code>Request=DescribeProcess&amp;Identifier=Hello
</code></pre><p>So put that all together and type in a new browser tab:</p>
<pre><code>http://localhost/cgi-bin/zoo_loader.cgi?Service=WPS&amp;Version=1.0.0&amp;Request=DescribeProcess&amp;Identifier=Hello
</code></pre><p>The server will send you an xml response desribing how to interact with your new &#39;Hello&#39; service.</p>
<p>Finally, it&#39;s time to Execute this service! From the DescribeProcess response we can see how to build up the URL to make a request to this service. Again we add the Request type (in this case Execute) and the service Identifier to our basic URL:</p>
<pre><code>&amp;Request=Execute&amp;Identifier=Hello
</code></pre><p>And finally the data inputs in the form expected by the python service code:</p>
<pre><code>&amp;DataInputs=name=yourname
</code></pre><p>So putting this all together:</p>
<pre><code>http://localhost/cgi-bin/zoo_loader.cgi?request=Execute&amp;service=WPS&amp;version=1.0.0&amp;Identifier=Hello&amp;DataInputs=name=yourname
</code></pre><p>If there are no mistakes in your python service file then this should provide you with an xml response, of which the wps:ProcessOutput has a wps:Data section containing the output string with the input name included in it:
<img src="../images/hello.png" alt="Hello"></p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../GettingStarted/Customising.html" class="navigation navigation-prev " aria-label="Previous page: Customising Your Server"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../Geoprocessing/Introduction.html" class="navigation navigation-next " aria-label="Next page: Basic Geoprocessing"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.4-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
